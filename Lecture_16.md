```python
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
from scipy.io import wavfile
from scipy.linalg import fractional_matrix_power
```


```python

```


```python
store_dataset = pd.read_csv("/home/excelsior/Desktop/StandordSC229/Stores.csv");

store_dataset
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Store ID</th>
      <th>Store_Area</th>
      <th>Items_Available</th>
      <th>Daily_Customer_Count</th>
      <th>Store_Sales</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1659</td>
      <td>1961</td>
      <td>530</td>
      <td>66490</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>1461</td>
      <td>1752</td>
      <td>210</td>
      <td>39820</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>1340</td>
      <td>1609</td>
      <td>720</td>
      <td>54010</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>1451</td>
      <td>1748</td>
      <td>620</td>
      <td>53730</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>1770</td>
      <td>2111</td>
      <td>450</td>
      <td>46620</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>891</th>
      <td>892</td>
      <td>1582</td>
      <td>1910</td>
      <td>1080</td>
      <td>66390</td>
    </tr>
    <tr>
      <th>892</th>
      <td>893</td>
      <td>1387</td>
      <td>1663</td>
      <td>850</td>
      <td>82080</td>
    </tr>
    <tr>
      <th>893</th>
      <td>894</td>
      <td>1200</td>
      <td>1436</td>
      <td>1060</td>
      <td>76440</td>
    </tr>
    <tr>
      <th>894</th>
      <td>895</td>
      <td>1299</td>
      <td>1560</td>
      <td>770</td>
      <td>96610</td>
    </tr>
    <tr>
      <th>895</th>
      <td>896</td>
      <td>1174</td>
      <td>1429</td>
      <td>1110</td>
      <td>54340</td>
    </tr>
  </tbody>
</table>
<p>896 rows Ã— 5 columns</p>
</div>




```python
# Store dataset's columns: 

store_dataset_columns = store_dataset.columns.to_numpy();
```


```python
# Convert store_dataset to numpy array:

store_dataset = store_dataset.to_numpy();
```


```python
# Remove <Store ID> column:

store_dataset = store_dataset[:,1:];

# Standardize store_dataset's features:

store_dataset = store_dataset - np.sum(store_dataset,axis=0)/len(store_dataset);

store_dataset_std = np.std(store_dataset, axis=0, ddof = 1);

for col in range(store_dataset.shape[1]):
     store_dataset[:,col] = store_dataset[:,col] / store_dataset_std[col];
        

# Standardized store_dataset's head:

print(store_dataset[:10]);
```

    [[ 0.69370395  0.59680215 -0.96594122  0.41526388]
     [-0.09754592 -0.10016177 -2.17171713 -1.13615258]
     [-0.5810875  -0.57703181 -0.25001178 -0.31070828]
     [-0.13750803 -0.11350079 -0.62681675 -0.32699611]
     [ 1.13728341  1.09701549 -1.2673852  -0.74059083]
     [-0.17347393 -0.16352212 -0.09928979 -0.81970318]
     [ 0.22614721  0.25332233  0.91808363  0.74974625]
     [-0.8967882  -0.91717688  0.88040313 -1.25831136]
     [-1.58014035 -1.53744142 -0.40073377 -0.75862379]
     [-1.81991304 -1.8242304   1.2948886  -0.88427282]]



```python
# Let's rename store_dataset as X for convenience: 

X = store_dataset;
```


```python

```


```python
## PRINCIPAL COMPONENT ANALYSIS ##
```


```python

```


```python
# Compute the correlation matrix of X:

correlation_matrix = (X.T @ X)/(len(X)-1);

correlation_matrix
```




    array([[ 1.        ,  0.99889075, -0.0414231 ,  0.0974738 ],
           [ 0.99889075,  1.        , -0.04097812,  0.09884943],
           [-0.0414231 , -0.04097812,  1.        ,  0.00862871],
           [ 0.0974738 ,  0.09884943,  0.00862871,  1.        ]])




```python
# Order by descending order the eigenvalues/eigenvectors with respect to eigenvalues's values: 

eigendecomposition = np.linalg.eig(correlation_matrix);
eigendecompositon_ordered_indices = eigendecomposition[0].argsort();
eigendecomposition_ordered = [None, None];

eigendecomposition_ordered[0] = eigendecomposition[0][eigendecompositon_ordered_indices][::-1];
eigendecomposition_ordered[1] = eigendecomposition[1][eigendecompositon_ordered_indices][::-1];

# Eigenvalues analysis of the correlation matrix:

eigenvalues = eigendecomposition_ordered[0];

eigenvalues_df = pd.DataFrame(

    {
        "Eigenvalues": eigenvalues,
        "Proportion": eigenvalues/np.sum(eigenvalues),
        "Cumulative": np.cumsum(eigenvalues/np.sum(eigenvalues))
        
    }
    
);

eigenvalues_df.T
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Eigenvalues</th>
      <td>2.020959</td>
      <td>1.007169</td>
      <td>0.970764</td>
      <td>0.001108</td>
    </tr>
    <tr>
      <th>Proportion</th>
      <td>0.505240</td>
      <td>0.251792</td>
      <td>0.242691</td>
      <td>0.000277</td>
    </tr>
    <tr>
      <th>Cumulative</th>
      <td>0.505240</td>
      <td>0.757032</td>
      <td>0.999723</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div>




```python
# Eigenvectors analysis of the correlation matrix:

eigenvectors = eigendecomposition_ordered[1];

eigenvectors_df = pd.DataFrame(data = eigendecomposition_ordered[1].T, index = store_dataset_columns[1:], 
                               columns = ["PC0","PC1","PC2","PC3"]);

eigenvectors_df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PC0</th>
      <th>PC1</th>
      <th>PC2</th>
      <th>PC3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Store_Area</th>
      <td>-0.699590</td>
      <td>-0.134066</td>
      <td>0.055334</td>
      <td>-0.699670</td>
    </tr>
    <tr>
      <th>Items_Available</th>
      <td>-0.707065</td>
      <td>-0.000979</td>
      <td>-0.000303</td>
      <td>0.707148</td>
    </tr>
    <tr>
      <th>Daily_Customer_Count</th>
      <td>-0.101491</td>
      <td>0.835113</td>
      <td>-0.531202</td>
      <td>-0.100550</td>
    </tr>
    <tr>
      <th>Store_Sales</th>
      <td>-0.018234</td>
      <td>0.533490</td>
      <td>0.845436</td>
      <td>-0.017130</td>
    </tr>
  </tbody>
</table>
</div>




```python

```


```python
## INDEPENDENT COMPONENT ANALYSIS ##
```


```python

```


```python
micro1_ica = wavfile.read("/home/excelsior/Desktop/StandordSC229/ICA_mix_1.wav");
micro2_ica = wavfile.read("/home/excelsior/Desktop/StandordSC229/ICA_mix_2.wav");
micro3_ica = wavfile.read("/home/excelsior/Desktop/StandordSC229/ICA_mix_3.wav");
```


```python
print(len(micro1_ica[1]));
print(len(micro2_ica[1]));
print(len(micro3_ica[1]));
```

    264515
    264515
    264515



```python
micro1_ica_data = micro1_ica[1];
micro2_ica_data = micro2_ica[1];
micro3_ica_data = micro3_ica[1];

micros_ica_data = np.c_[micro1_ica_data, micro2_ica_data, micro3_ica_data];
```


```python
fig, ax = plt.subplots(2,3, figsize = (7,7));
ax[0,0].hist(micro1_ica_data, bins =50);
ax[0,1].hist(micro2_ica_data, bins =50);
ax[0,2].hist(micro3_ica_data, bins =50);

ax[1,0].scatter(micro1_ica_data,micro2_ica_data);
ax[1,1].scatter(micro1_ica_data,micro3_ica_data);
ax[1,2].scatter(micro2_ica_data,micro3_ica_data);

```


    
![png](output_19_0.png)
    



```python

```


```python
# The first step in many ICA algorithms is to remove any correlations in the data.
# i.e. the observed signals are forced to be uncorrelated.

micros_ica_data = micros_ica_data - np.sum(micros_ica_data, axis=0)/len(micros_ica_data);

C = (micros_ica_data.T @ micros_ica_data)/(len(micros_ica_data)-1);

V = fractional_matrix_power(C,-1/2);

Y = micros_ica_data @ V.T;

fig1, ax1 = plt.subplots(2,3, figsize = (7,7));
ax1[0,0].hist(Y[:,0], bins =50);
ax1[0,1].hist(Y[:,1], bins =50);
ax1[0,2].hist(Y[:,2], bins =50);

ax1[1,0].scatter(Y[:,0],Y[:,1]);
ax1[1,1].scatter(Y[:,0],Y[:,2]);
ax1[1,2].scatter(Y[:,1],Y[:,2]);
```


    
![png](output_21_0.png)
    



```python

```


```python
def gradientLogW(Y_, W):

    m = Y_.shape[0];
    n = Y_.shape[1];
    sum_ = 0;
    
    for i in range(m):
        xi = Y_[i];
            
        for j in range(n):
            cj = np.zeros(n);
            cj[j] = 1;

            sum_ += np.outer(cj,xi)*(1-2*logisticFunction(np.dot(W[j],xi)));
            
    sum_ += sum_ + m*n*np.linalg.inv(W).T;

    return sum_;

def logisticFunction(x):
    
    if x <= -100:
        return 0;
    elif x >= 100:
        return 1;
    else:
        return 1/(1+np.e**(-x));

def gradientAscentW(Y, W, number_of_iterations, alpha):
    
    W_hat_ = W;
    
    for i in range(number_of_iterations):
        
        print(i);
        print(W_hat_);
        print("**");
        
        W_hat_ = W_hat_ + alpha*gradientLogW(Y, W_hat_);
        
    return W_hat_;
```


```python
alpha = 0.0001;
a1 = np.pi/2;
a2 = 0;
a3 = -np.pi/2;
# W = np.array(
#     [[np.cos(a1)*np.cos(a2), np.cos(a1)*np.sin(a2)*np.sin(a3)-np.sin(a1)*np.cos(a3), np.cos(a1)*np.sin(a2)*np.cos(a3)+np.sin(a1)*np.sin(a3)],
#      [np.sin(a1)*np.cos(a2), np.sin(a1)*np.sin(a2)*np.sin(a3)+np.cos(a1)*np.cos(a3), np.sin(a1)*np.sin(a2)*np.cos(a3)-np.cos(a1)*np.sin(a3)],
#      [-np.sin(a2), np.cos(a2)*np.sin(a3), np.cos(a2)*np.cos(a3)]]
# );

W = np.array([[-32.62237095, -12.47803716, -6.62404943],
              [7.38841354, -12.8469532, -3.93529071],
              [-3.62988946, -7.05053108, 8.65540455]]);


number_of_iterations = 10000;
```


```python
W_test = gradientAscentW(Y, W, number_of_iterations, alpha);
```

    0
    [[-32.62237095 -12.47803716  -6.62404943]
     [  7.38841354 -12.8469532   -3.93529071]
     [ -3.62988946  -7.05053108   8.65540455]]
    **
    1
    [[  2.21852993  -2.57746574   3.30499554]
     [ -7.75322988  17.39756588   9.54409269]
     [  5.90567774   9.1921378  -19.66432409]]
    **
    2
    [[ 12.36038936  21.93584036 -15.40117282]
     [  6.66537043 -11.46962391 -13.60124677]
     [  1.69314396   1.72538155  20.54562632]]
    **
    3
    [[  2.10959684  -2.00630497  10.69148598]
     [  1.12744304   8.99170113  23.90010472]
     [  6.00726627  -8.37993853 -22.03257083]]
    **
    4
    [[ -3.76062124 -13.65516576 -28.74257774]
     [ 11.710557     1.4066916  -21.19952893]
     [ 10.07374184  10.9113226   20.14261259]]
    **
    5
    [[  8.84592732 -14.3985299   19.7634079 ]
     [ -6.64947882  13.0787931   16.7355522 ]
     [ 12.45617079 -25.02406772 -13.74161994]]
    **
    6
    [[  34.32943055   23.40582143  -14.62338871]
     [-107.59399024  -68.59583658  -15.76049113]
     [ -81.62555669  -37.21643423   14.59824497]]
    **
    7
    [[ -0.62586627  15.5793748   -0.70949437]
     [-73.87555288 -52.4994425   -6.21240733]
     [-47.33016278 -22.90017572   8.47373427]]
    **
    8
    [[  0.15132417 -19.92908584  -6.16429157]
     [-42.16586975 -33.31785517  -1.1664053 ]
     [-11.02143471 -12.30470165   8.29974016]]
    **
    9
    [[  1.27307     14.98196682  10.18418563]
     [-13.50877432 -11.44347791   3.89905243]
     [ 12.15772433   6.35357293  -7.40913639]]
    **
    10
    [[-28.21528918   7.4666977  -45.47085945]
     [-65.63938604  70.04382224 -86.60612075]
     [-99.82640586  63.13523568 -70.88668729]]
    **
    11
    [[-10.03097913   3.48584476  -7.66581115]
     [-44.80271239  52.4619312  -56.31789759]
     [-73.4127526   46.73624991 -45.39709015]]
    **
    12
    [[ 17.185405   -23.63042381   3.56228447]
     [-23.96627849  31.8342503  -29.07221855]
     [-46.01080337  31.8934121  -20.04336021]]
    **
    13
    [[ -5.71779184   4.63449494  -4.11385853]
     [ -3.46761061   8.61822067  -5.41846045]
     [-18.86720528   9.56382337  -4.36905634]]
    **
    14
    [[ 14.50316917 -48.17161825 -30.9782278 ]
     [ 15.9469815   -2.6797579   28.27708056]
     [ 12.96776585   0.76561916  16.20756502]]
    **
    15
    [[  6.16557634 -17.07947095  -2.33453511]
     [ -8.8237916  -10.49676849  -6.13531502]
     [  6.06603711   5.81558862 -28.95598077]]
    **
    16
    [[-2.08106788 18.04463825  7.03863566]
     [ 5.26306759 15.11034272 16.96006546]
     [-0.73329649  5.22419416 13.46534667]]
    **
    17
    [[ -3.62382201 -14.66791857 -15.76263027]
     [ 10.61493616  -8.82152124 -20.90823747]
     [ -9.12634533 -15.19652643 -24.13260953]]
    **
    18
    [[ 3.8608066  -3.8535116  30.23050065]
     [ 1.33374512  9.18110068 18.04083184]
     [-6.99095185 13.66113223 10.30038758]]
    **
    19
    [[ -4.22001551  -9.62628743 -12.75986021]
     [ 15.62000527  -1.39332538 -26.29506468]
     [ -4.92117245 -16.56736708 -19.00378039]]
    **
    20
    [[-29.8499149   46.7280916    5.92277253]
     [  0.38475396   5.94843676  13.56854091]
     [ 18.15020254 -15.94636207  31.79119722]]
    **
    21
    [[-28.13859527   1.52158442   2.06387409]
     [ 68.96841026  33.99891893 -46.52295105]
     [-24.31182525 -21.20398028   3.04185179]]
    **
    22
    [[  9.20695615   0.96913422  -4.09210383]
     [ 39.02126033  25.2325126  -22.00998687]
     [  5.09064262  -2.89087368   0.15879339]]
    **
    23
    [[-41.01792631 -27.58913804 -43.93083099]
     [ 12.0214214   17.8670406    8.24292268]
     [ -8.52261693  24.80699554  48.63586687]]
    **
    24
    [[-21.77744319  -8.38603862 -10.81018589]
     [ -5.64221045  -6.3521656  -18.10740375]
     [ -5.05668868   6.53502734   6.43981192]]
    **
    25
    [[  7.444817    -1.26859915  14.35070753]
     [  1.71911303  16.39759052  18.38534092]
     [  8.25344567  -5.3435595  -29.79653449]]
    **
    26
    [[ -2.26316751  -5.8503951  -25.03235313]
     [  2.47094627  -3.66881742 -20.99813968]
     [  3.83917451   7.48338731  13.29886257]]
    **
    27
    [[-22.75998414  30.04575743  13.95104186]
     [ 20.34287673  -5.10211617  25.77723661]
     [ -7.93118437   9.82562232 -33.26539239]]
    **
    28
    [[ -2.33912419   1.52617087  -6.2940618 ]
     [  2.91102487   1.13587846 -11.11150865]
     [  2.91753493   7.89178501   8.06619105]]
    **
    29
    [[ -8.51385625   7.59231928  31.45565686]
     [  5.05047842   3.32045669  29.4210581 ]
     [ -2.08277553 -10.30744871 -26.85440141]]
    **
    30
    [[ -7.05959086  -7.52210739 -11.96385424]
     [  4.73377927 -15.18952739 -13.23753859]
     [ -5.00378733  -6.04807114  19.70189506]]
    **
    31
    [[ -0.89672722  11.71145291  24.38887363]
     [  0.90854058   9.24663467  21.32762363]
     [  2.1493513   -3.81916864 -21.10713217]]
    **
    32
    [[-29.55690851  10.98277639 -25.72998383]
     [ 42.7180571  -17.15904651 -17.00986711]
     [  5.10488314  19.31569785  19.46423345]]
    **
    33
    [[ -1.58412109   5.33564774   1.98498572]
     [  9.80436762  -2.34938077   0.34304818]
     [  1.97073106  -3.58166913 -17.53759707]]
    **
    34
    [[ 12.29372218 -12.78302959 -19.23265596]
     [-20.43720386   8.08302691   0.72651447]
     [ -1.17203163  11.00052346  23.10998161]]
    **
    35
    [[ 42.41109438 127.09768719 -35.70837923]
     [ 38.79300967  61.57577672 -33.47612934]
     [ 38.17840512  90.09802157 -61.72738183]]
    **
    36
    [[ 35.83430928  90.93832376 -25.43537305]
     [ 29.28280246  32.36460577 -10.72044259]
     [ 27.03380855  61.88253129 -38.34436088]]
    **
    37
    [[ 26.93394741  56.15879603 -14.41482206]
     [ 10.38032896   5.3319532    0.99691425]
     [ 17.64763026  31.48634826 -18.13939931]]
    **
    38
    [[ 14.7476323   23.42423435  -3.52810918]
     [-15.55859688 -12.08928447  -3.84657789]
     [  7.11379672   0.15803305  -2.85617175]]
    **
    39
    [[ -2.70669779  -7.05594584  -7.90594726]
     [ 10.08721571  10.71909761   2.23779098]
     [-21.64719646  -3.50695202   4.52454061]]
    **
    40
    [[ -0.46402776  25.16341398  14.5313879 ]
     [-18.57423228  -2.89297494 -22.61964213]
     [ 12.1711155    3.83120254  -7.99400117]]
    **
    41
    [[  0.09265558  -5.97866862 -13.06498666]
     [  1.67809438   4.74842148  12.60049255]
     [-15.26870874   1.28211065  15.08219204]]
    **
    42
    [[ 12.02054333 -40.30240934  48.71066828]
     [ 17.30265227 -58.8027365   -9.92345392]
     [  7.43007019  -9.9268632  -17.3025355 ]]
    **
    43
    [[  9.65424686 -17.13532403  15.39113217]
     [  0.67136965 -22.89662643  -0.03415188]
     [ 14.37669233  14.80615256  23.73783057]]
    **
    44
    [[-171.53351102    3.83540867   91.77235958]
     [ 192.00556376   20.05596814 -115.86035372]
     [ 108.85258759   -1.53730034  -78.97544138]]
    **
    45
    [[-138.61456906    2.16364558   66.03785852]
     [ 158.89917157   24.3578079   -90.22283274]
     [  75.76340792    0.34171785  -53.70213179]]
    **
    46
    [[-104.60932898    0.46228225   42.43890503]
     [ 125.25348335   27.04064691  -65.73163819]
     [  42.19038167    1.32447806  -29.71000804]]
    **
    47
    [[-69.43289581  -0.81298675  21.60682445]
     [ 91.05885258  27.93133914 -42.7204818 ]
     [  8.07723805   0.55318369  -7.89188952]]
    **
    48
    [[-32.81431551  -0.535904     5.5530713 ]
     [ 56.2819407   26.25224662 -22.12485053]
     [-22.77504086  -5.57704631  10.80027532]]
    **
    49
    [[ 3.3927565  -0.30698335 -8.8634567 ]
     [22.17475702 22.19344556 -1.54406031]
     [15.20576702  6.56968832  8.42867966]]
    **
    50
    [[ -2.2264895   -1.1153461   28.64767448]
     [ -5.94728842   1.24426898  -6.90748683]
     [ -9.10931865 -13.06945572 -13.06794769]]
    **
    51
    [[ -1.63195367  -6.46270659 -14.99812491]
     [  6.62497393   7.28611347  27.51109995]
     [  3.76927923   6.98946598  20.5152    ]]
    **
    52
    [[ 750.94456592  576.10763479 -301.57822854]
     [-485.47548769 -410.67087165  210.0149333 ]
     [1202.89593125  947.48103411 -566.75289035]]
    **
    53
    [[ 721.7599331   558.94557875 -284.08354925]
     [-455.21637275 -395.02899522  192.22076369]
     [1173.63620879  930.54978476 -548.9693913 ]]
    **
    54
    [[ 692.54620473  541.64007715 -266.93994629]
     [-425.35558183 -378.52323597  175.12653811]
     [1144.35447181  913.61617653 -531.2517589 ]]
    **
    55
    [[ 663.32182541  524.15389573 -250.18484487]
     [-395.85676296 -361.23915588  158.72097601]
     [1115.07738646  896.62346069 -513.63904923]]
    **
    56
    [[ 634.11371477  506.45144062 -233.83332597]
     [-366.71828842 -343.223789    142.97847385]
     [1085.83096347  879.53474505 -496.13984341]]
    **
    57
    [[ 604.93488151  488.53240087 -217.86608502]
     [-337.94849369 -324.47008626  127.96591791]
     [1056.63133293  862.31934973 -478.77462354]]
    **
    58
    [[ 575.78434968  470.38785568 -202.32023038]
     [-309.54627611 -305.00845363  113.68747394]
     [1027.47149164  844.97762898 -461.56059222]]
    **
    59
    [[ 546.6846896   451.98436026 -187.22634871]
     [-281.58815124 -284.74437861  100.26171983]
     [ 998.35086253  827.5095394  -444.50204105]]
    **
    60
    [[ 517.64475266  433.3186887  -172.58690971]
     [-254.12043197 -263.64940983   87.73478398]
     [ 969.28004119  809.89480065 -427.61576434]]
    **
    61
    [[ 488.67889224  414.3583032  -158.46107883]
     [-227.16320156 -241.71599694   76.17463056]
     [ 940.26527211  792.13103221 -410.89605726]]
    **
    62
    [[ 459.81331165  395.07424634 -144.86942714]
     [-200.73186982 -218.9364228    65.67287397]
     [ 911.31996863  774.19762245 -394.35590955]]
    **
    63
    [[ 431.05759202  375.4415049  -131.87823684]
     [-174.84523249 -195.29488428   56.34977681]
     [ 882.44195746  756.09472451 -378.00480281]]
    **
    64
    [[ 402.42886402  355.44016228 -119.52224076]
     [-149.68645937 -170.53707829   48.63863124]
     [ 853.64566947  737.81064663 -361.83784697]]
    **
    65
    [[ 373.93522067  335.06401131 -107.82962329]
     [-125.01964787 -145.21719469   41.46431824]
     [ 824.96393365  719.29528276 -345.88503567]]
    **
    66
    [[ 345.57476212  314.33659489  -96.77646259]
     [-100.65616663 -119.67608212   34.30546466]
     [ 796.40990954  700.5342506  -330.15249543]]
    **
    67
    [[ 317.40462745  293.19769032  -86.39402502]
     [ -76.56246405  -93.97437456   27.14940958]
     [ 767.98618584  681.52643141 -314.64463813]]
    **
    68
    [[ 289.42164633  271.66961661  -76.66709637]
     [ -52.80017996  -68.10483875   19.9963184 ]
     [ 739.69063782  662.26922168 -299.38089547]]
    **
    69
    [[ 261.66115413  249.71419695  -67.64424543]
     [ -29.5181691   -42.05465367   12.78550039]
     [ 711.52290278  642.77192463 -284.35123609]]
    **
    70
    [[ 234.07791356  227.39422604  -59.32567001]
     [  -7.19448184  -15.72835065    5.46825735]
     [ 683.49814743  623.00816348 -269.58623189]]
    **
    71
    [[ 206.51207564  204.8826554   -51.73455331]
     [  10.50469721   11.20559361   -3.24014522]
     [ 655.60534804  602.99052336 -255.09552717]]
    **
    72
    [[ 182.73828112  178.82908146  -43.10500364]
     [ -94.91414426   58.12805378  -33.18106747]
     [ 628.03193622  582.54398794 -240.82182957]]
    **
    73
    [[ 155.02467629  156.25622617  -36.56079901]
     [ -62.39164121   40.64854911  -20.62346033]
     [ 600.33055212  562.06079428 -226.99876855]]
    **
    74
    [[ 128.19083906  132.79996987  -30.18317464]
     [ -30.56985746   22.11399512   -9.22809189]
     [ 572.74117114  541.33409591 -213.50998417]]
    **
    75
    [[ 1.02268920e+02  1.08550452e+02 -2.36711371e+01]
     [-5.53060966e-01  1.93318308e+00  9.52887254e-02]
     [ 5.45248584e+02  5.20381230e+02 -2.00364982e+02]]
    **
    76
    [[  78.94048547   82.24779494  -15.78851491]
     [ -31.11144001    3.28425031  -27.15804322]
     [ 517.59316382  499.39448153 -187.78308172]]
    **
    77
    [[  50.32546543   60.50050906  -10.81823403]
     [  -4.69648661    4.05481934    3.69066004]
     [ 490.85691679  477.49407708 -175.12635089]]
    **
    78
    [[  39.16379976   26.25909363    7.37780532]
     [  -4.17513204   -3.74896917  -47.15728218]
     [ 462.61154581  456.50702641 -164.25119893]]
    **
    79
    [[ 1.34760412e+01  8.45337054e-01 -5.48256391e+00]
     [-3.83999551e-01  2.61416867e+00 -2.69996726e+00]
     [ 4.35455089e+02  4.35077867e+02 -1.51545159e+02]]
    **
    80
    [[ -19.36163554   -3.47784988    6.49532341]
     [  -6.95579545  -19.03532247   -0.45360849]
     [ 408.93815724  412.89019376 -139.17949132]]
    **
    81
    [[   6.27648779    3.1115218   -29.04301899]
     [  -7.74552735   19.14702587  -21.30305097]
     [ 382.02974243  390.36160643 -128.98885054]]
    **
    82
    [[-8.62883927e-02  2.91761565e+00  1.36363176e+01]
     [-5.52793954e-01 -1.53319199e+00  1.10074031e+01]
     [ 3.56058959e+02  3.67310586e+02 -1.17638453e+02]]
    **
    83
    [[ -17.77942125    8.87183608  -30.21511066]
     [  28.28250053  -25.97228548  -29.25879808]
     [ 330.3891229   343.76348533 -106.95731179]]
    **
    84
    [[ -1.21213237   4.10971502   7.30072971]
     [  8.5575783   -4.68496499   2.23926923]
     [304.69303163 320.03488726 -96.98464218]]
    **
    85
    [[  2.99545181 -12.21566129 -26.01196136]
     [-19.78248943   6.94846136  -3.30612539]
     [279.16549412 295.93842364 -87.74665756]]
    **
    86
    [[ -0.60112842   4.9762328   15.15861021]
     [ 15.3489991   -1.50474269   0.93846695]
     [253.8234433  271.501545   -79.13130266]]
    **
    87
    [[  1.28625115  -8.85730969 -24.99975802]
     [-19.87749641  -1.42832281   0.60677917]
     [228.67640556 246.75330709 -71.0400496 ]]
    **
    88
    [[ -1.05577053   6.2395364   16.90281429]
     [ 15.97986207   2.27499619  -2.40499573]
     [203.75705036 221.69265151 -63.40232155]]
    **
    89
    [[  2.06514974  -9.17947574 -23.25735947]
     [-17.46548854  -4.10823398   6.44517409]
     [179.08407231 196.35644715 -56.06411778]]
    **
    90
    [[ -2.48050376   7.74754364  17.54517083]
     [ 12.40650602   4.51964327 -12.58316785]
     [154.58850096 170.86106688 -48.87962621]]
    **
    91
    [[ 17.4698558  -20.66978179 -14.81281021]
     [ 14.70994237 -20.76226911  34.77161185]
     [129.20793971 146.07094329 -42.23695928]]
    **
    92
    [[ -1.68646934   4.94865731  10.67171695]
     [  3.2290323   -5.46929679  -0.98953008]
     [106.47477567 119.38115056 -34.19800153]]
    **
    93
    [[  5.41532011 -12.90860121 -25.00765968]
     [ -2.63881524  19.90388806  14.85919238]
     [ 83.52272479  92.87814547 -26.61159342]]
    **
    94
    [[ -7.2657328   10.1371585   11.23045082]
     [ -7.92142723  -3.95582792 -23.3630273 ]
     [ 60.92311383  66.34540888 -18.69059718]]
    **
    95
    [[  2.98525823 -10.05458545 -23.50714943]
     [ -1.69610357   7.78657435  18.22190828]
     [ 37.01490488  41.0456921  -11.80372059]]
    **
    96
    [[  97.62319509  -69.59679791   62.60317429]
     [ 128.78973574 -107.54987617   32.18129929]
     [  13.27197396   16.4258057    -4.73845725]]
    **
    97
    [[ 69.50840468 -50.40609047  42.54037372]
     [ 99.44867445 -83.50188099  23.44121572]
     [ -5.00045967  -9.57071898   2.41410758]]
    **
    98
    [[ 41.18468725 -30.47917956  24.31370871]
     [ 70.32938969 -59.3548827   14.78039377]
     [  2.05339041  19.45787381  -2.83873284]]
    **
    99
    [[ 12.48153974  -9.97874317   8.91949182]
     [ 41.8335793  -34.76184383   6.23728072]
     [  5.58783687 -16.7956603   -0.81185598]]
    **
    100
    [[-16.71775853   8.4029422   -2.56108819]
     [ 15.08961619  -8.38932406  -0.42380267]
     [-11.33849061  15.5996494    4.80490912]]
    **
    101
    [[ 26.91274205   7.88713678 -28.56749625]
     [ -3.08456606  32.79246852 -32.58742536]
     [ 15.01960995  -6.7330998  -13.8285506 ]]
    **
    102
    [[  8.29506163  10.16275262  11.06678405]
     [ -2.07598807   6.78783097  -3.18467561]
     [-16.68642499  -1.59112197  10.93042409]]
    **
    103
    [[ -4.85860146 -11.31664466 -19.52740063]
     [  4.36949759 -18.87867357   8.34567339]
     [ 12.25067714  -2.68125031 -13.67335866]]
    **
    104
    [[-3.32778038  6.87697052 20.34248011]
     [-3.43381125 13.62237206 -5.81657683]
     [-6.37040245  6.2353299  21.54096833]]
    **
    105
    [[ 27.76231951   0.15950881 -19.05975127]
     [  4.24302231 -17.48809099   7.47189059]
     [-23.42204025 -14.89969234 -24.49043173]]
    **
    106
    [[-2.14680231  3.40741979  7.41334416]
     [-3.98501598 14.6789741  -6.35715345]
     [-2.88295291  0.96212761  8.02951455]]
    **
    107
    [[ 57.03499645   6.74137528 -19.16204965]
     [ -2.5609196  -19.16849771   5.74390004]
     [-46.21482483 -25.7037994  -43.31089671]]
    **
    108
    [[ 20.35315645   6.29030373  -4.73966044]
     [ -1.47597416  15.16520788  -3.05695867]
     [-22.88936665 -10.35351748 -11.77380705]]
    **
    109
    [[-1.47060347e+01 -9.20052377e-02 -1.61514274e-02]
     [ 2.35513046e+00 -1.92123413e+01  1.96836604e+00]
     [ 7.58561642e+00  2.65638622e+00  6.85523636e+00]]
    **
    110
    [[ 19.96568319  -1.59142146   5.55916332]
     [ -3.78329907  16.81484747   2.04083519]
     [-18.08791719  -7.0885346  -14.10167072]]
    **
    111
    [[-11.35127538   3.93530684 -16.86924946]
     [  6.71596979 -16.85197651 -12.16265664]
     [ 12.48418678   7.1984814    5.33252024]]
    **
    112
    [[  8.53227102   3.43494104  17.43058398]
     [ -2.06621828  11.14551058  16.48837734]
     [-13.00503804  -5.87284443 -17.53769673]]
    **
    113
    [[-12.10791476 -25.86553427 -13.06817186]
     [ -1.41689196  -4.51815005 -24.80547069]
     [ -4.43701576  -7.23769105  28.61320817]]
    **
    114
    [[  862.27612798  -413.91382138    39.51640919]
     [-2332.55472568  1137.28795268   -54.81419299]
     [-1625.86295219   783.41175726   -66.50279941]]
    **
    115
    [[ 1055.310856      65.85751334  -113.13478656]
     [-2319.62747909  1073.4245693    -38.24921951]
     [-1431.97310725  1084.66690071  -173.97929768]]
    **
    116
    [[ 1015.34105441    66.82286632  -106.77195267]
     [-2282.06823741  1059.29605416   -38.3762766 ]
     [-1400.28318492  1061.03852889  -173.21619401]]
    **
    117
    [[  975.357427      67.67372988  -100.60115029]
     [-2244.54401331  1045.08870651   -38.62235711]
     [-1368.5895571   1037.44685949  -172.24056066]]
    **
    118
    [[  935.3629865     68.4051458    -94.6083501 ]
     [-2207.05066892  1030.81304702   -38.95373012]
     [-1336.89955687  1013.87963838  -171.07459015]]
    **
    119
    [[  895.36030733    69.02197616   -88.77653294]
     [-2169.58913065  1016.46849179   -39.341467  ]
     [-1305.21227179   990.33370049  -169.74971452]]
    **
    120
    [[  855.35120702    69.5281429    -83.09571796]
     [-2132.15799167  1002.05893118   -39.76986484]
     [-1273.53053599   966.80307789  -168.28342717]]
    **
    121
    [[  815.33942748    69.89562595   -77.56184953]
     [-2094.75143666   987.59722454   -40.23381792]
     [-1241.8591135    943.28158854  -166.67878021]]
    **
    122
    [[  775.32675887    70.11378422   -72.17890704]
     [-2057.36952846   973.08366288   -40.72879666]
     [-1210.19552361   919.77058008  -164.95011869]]
    **
    123
    [[  735.3155412     70.1765533    -66.94197921]
     [-2020.01549767   958.5120435    -41.24468271]
     [-1178.54199802   896.26701298  -163.1010017 ]]
    **
    124
    [[  695.30728419    70.09843713   -61.83639555]
     [-1982.68452929   943.89292744   -41.77838007]
     [-1146.89486146   872.77401398  -161.143718  ]]
    **
    125
    [[  655.30376481    69.87236589   -56.86689019]
     [-1945.37986124   929.22022069   -42.31842177]
     [-1115.25647268   849.28925259  -159.07661503]]
    **
    126
    [[  615.30733895    69.48902465   -52.03626145]
     [-1908.10243707   914.49216024   -42.86550279]
     [-1083.63170518   825.80717695  -156.89763239]]
    **
    127
    [[  575.32283572    68.92666189   -47.33863764]
     [-1870.85061127   899.71271581   -43.41431967]
     [-1052.02079863   802.32614161  -154.61631238]]
    **
    128
    [[  535.35501588    68.15287981   -42.78885022]
     [-1833.6259975    884.87895538   -43.96137004]
     [-1020.42245933   778.8477211   -152.23576733]]
    **
    129
    [[  495.40788227    67.1600623    -38.38379622]
     [-1796.42776248   869.99289444   -44.50657481]
     [ -988.83780845   755.37149258  -149.75287701]]
    **
    130
    [[  455.48819188    65.92102277   -34.12430654]
     [-1759.25607515   855.0549569    -45.04037077]
     [ -957.26833854   731.89550283  -147.17004026]]
    **
    131
    [[  415.60057095    64.42766546   -30.01567801]
     [-1722.11240453   840.06286748   -45.55421739]
     [ -925.71302379   708.42092588  -144.49052186]]
    **
    132
    [[  375.75190554    62.66234439   -26.06513297]
     [-1684.99789504   825.01421736   -46.05517121]
     [ -894.17300537   684.9479122   -141.70862632]]
    **
    133
    [[  335.95306561    60.59238234   -22.27628013]
     [-1647.91533937   809.90389941   -46.53844798]
     [ -862.6536691    661.47164008  -138.81610647]]
    **
    134
    [[  296.22453818    58.14025467   -18.65738469]
     [-1610.86266528   794.73650724   -47.00402333]
     [ -831.15405626   637.99219124  -135.82134545]]
    **
    135
    [[  256.58755512    55.25006213   -15.20846263]
     [-1573.83748918   779.51742944   -47.44906703]
     [ -799.67407448   614.50983031  -132.7264678 ]]
    **
    136
    [[  217.07122292    51.85048705   -11.93960936]
     [-1536.84566326   764.23538888   -47.87051211]
     [ -768.2174398    591.02182191  -129.5244949 ]]
    **
    137
    [[  177.71238756    47.87055902    -8.86973414]
     [-1499.88671832   748.89158775   -48.27121716]
     [ -736.7850657    567.52828754  -126.21247809]]
    **
    138
    [[  138.57777519    43.16831317    -6.05686968]
     [-1462.96041038   733.4866825    -48.65530781]
     [ -705.37340959   544.03448666  -122.79079123]]
    **
    139
    [[   99.82285786    37.39893934    -3.58547316]
     [-1426.06960688   718.01591497   -49.01480806]
     [ -673.98197896   520.54188384  -119.25933213]]
    **
    140
    [[   61.73421037    30.07919847    -1.54597752]
     [-1389.21677088   702.47457561   -49.35448889]
     [ -642.61345124   497.04955844  -115.61070286]]
    **
    141
    [[ 2.51485087e+01  1.99996358e+01 -2.59129824e-01]
     [-1.35240849e+03  6.86849706e+02 -4.96806448e+01]
     [-6.11266632e+02  4.73561438e+02 -1.11838872e+02]]
    **
    142
    [[-4.81842673e+00  1.61909242e+00 -9.38189776e-01]
     [-1.31565015e+03  6.71130419e+02 -5.00052481e+01]
     [-5.79950163e+02  4.50071299e+02 -1.07927626e+02]]
    **
    143
    [[   14.87147884   -44.51252911   -59.14796554]
     [-1278.95730986   655.28142444   -50.40146325]
     [ -548.51808257   426.90961439  -103.28870819]]
    **
    144
    [[    8.13927395   -22.31946735   -19.63853084]
     [-1242.37849884   639.19549867   -51.04026373]
     [ -517.10395193   403.77855078   -98.46094824]]
    **
    145
    [[   -1.67936634     4.22631554    12.3306609 ]
     [-1205.83572277   623.05214874   -51.57570673]
     [ -485.7641987    380.55692464   -93.65117653]]
    **
    146
    [[    3.90204367    -8.26879215   -26.64541088]
     [-1169.35403441   606.79478903   -52.11620966]
     [ -454.42066964   357.42135875   -88.55243421]]
    **
    147
    [[   -1.19355143     5.28184384    15.6177111 ]
     [-1132.91262936   590.47080205   -52.58467078]
     [ -423.12719555   334.25392319   -83.37243543]]
    **
    148
    [[    2.73699444    -7.84478044   -24.82520793]
     [-1096.50733814   574.09141529   -52.95410861]
     [ -391.89948885   311.02464458   -78.15982821]]
    **
    149
    [[   -1.573237       5.74078656    17.33413463]
     [-1060.14577222   557.63993297   -53.25844265]
     [ -360.73282571   287.75807672   -72.85028657]]
    **
    150
    [[    2.57311835    -7.48962774   -23.55679209]
     [-1023.82917038   541.11685796   -53.47743511]
     [ -329.63913307   264.43299215   -67.48071523]]
    **
    151
    [[  -1.74259033    6.05799647   18.43904117]
     [-987.56197635  524.51416142  -53.61777497]
     [-298.60941017  241.07369127  -62.01475597]]
    **
    152
    [[   2.42316242   -7.2613579   -22.70026294]
     [-951.34992019  507.82398938  -53.6613591 ]
     [-267.66182145  217.65695952  -56.47356299]]
    **
    153
    [[  -1.85238544    6.27557205   19.17611499]
     [-915.19861265  491.03637965  -53.61488897]
     [-236.79297769  194.19981118  -50.83172679]]
    **
    154
    [[   2.31423633   -7.11329054  -22.10953693]
     [-879.0975242   474.17246013  -53.47781218]
     [-206.01344895  170.69248962  -45.10937927]]
    **
    155
    [[  -1.91870857    6.43512482   19.67505836]
     [-843.04960441  457.2281911   -53.24969512]
     [-175.34585108  147.12771606  -39.27350012]]
    **
    156
    [[   2.22842052   -7.02669136  -21.69750611]
     [-807.05906018  440.1984046   -52.92056199]
     [-144.81763146  123.48756981  -33.33229346]]
    **
    157
    [[  -1.9506839     6.56510798   20.01271708]
     [-771.13126065  423.07451206  -52.49314387]
     [-114.45461381   99.77655871  -27.25407395]]
    **
    158
    [[   2.14958733   -6.99756078  -21.40455739]
     [-735.27067096  405.85126377  -51.95834541]
     [ -84.30610434   75.98037536  -21.04698268]]
    **
    159
    [[  -1.94390612    6.70138889   20.23416504]
     [-699.47584295  388.53361308  -51.31278255]
     [ -54.48711373   52.06966783  -14.65314405]]
    **
    160
    [[   2.04470015   -7.06091979  -21.1801987 ]
     [-663.73882185  371.1379278   -50.55638683]
     [ -25.27723208   27.94746594   -8.0587803 ]]
    **
    161
    [[  -1.84492259    6.95447659   20.34597024]
     [-628.04362507  353.69354845  -49.69853837]
     [   2.31885535    3.36939158   -1.16411413]]
    **



    ---------------------------------------------------------------------------

    KeyboardInterrupt                         Traceback (most recent call last)

    Input In [48], in <cell line: 3>()
          1 # More work needs to be done on the algorithm, unsatisfactory operation.
    ----> 3 W_test = gradientAscentW(Y, W, number_of_iterations, alpha)


    Input In [7], in gradientAscentW(Y, W, number_of_iterations, alpha)
         36     print(W_hat_);
         37     print("**");
    ---> 39     W_hat_ = W_hat_ + alpha*gradientLogW(Y, W_hat_);
         41 return W_hat_


    Input In [7], in gradientLogW(Y_, W)
         11         cj = np.zeros(n);
         12         cj[j] = 1;
    ---> 14         sum_ += np.outer(cj,xi)*(1-2*logisticFunction(np.dot(W[j],xi)));
         16 sum_ += sum_ + m*n*np.linalg.inv(W).T;
         18 return sum_


    KeyboardInterrupt: 



```python
# W_test = W;

W_test = np.array([[-1.84492259, 6.95447659, 20.34597024],
                   [-628.04362507, 353.69354845, -49.69853837],
                   [2.31885535, 3.36939158, -1.16411413]]);

S_hat = Y @ W_test.T;
```


```python
fig2, ax2 = plt.subplots(2,3, figsize = (7,7));
ax2[0,0].hist(S_hat[:,0], bins =50);
ax2[0,1].hist(S_hat[:,1], bins =50);
ax2[0,2].hist(S_hat[:,2], bins =50);

ax2[1,0].scatter(S_hat[:,0],S_hat[:,1]);
ax2[1,1].scatter(S_hat[:,0],S_hat[:,2]);
ax2[1,2].scatter(S_hat[:,1],S_hat[:,2]);
```


    
![png](output_27_0.png)
    



```python
# Recover and rebuild the original sources disentangle;

S1 = S_hat/1000;

wavfile.write("/home/excelsior/Desktop/StandordSC229/speaker_1_S1.wav", micro1_ica[0], S1[:,0]);
wavfile.write("/home/excelsior/Desktop/StandordSC229/speaker_2_S1.wav", micro2_ica[0], S1[:,1]);
wavfile.write("/home/excelsior/Desktop/StandordSC229/speaker_3_S1.wav", micro3_ica[0], S1[:,2]);
```
